    # PostgreSQL Scanning Methods (스캔 방식)

## 개요
PostgreSQL은 쿼리 최적화를 위해 다양한 스캔 방식을 사용합니다. 데이터베이스는 쿼리 플래너를 통해 가장 효율적인 스캔 방식을 자동으로 선택합니다.

## 스캔 종류

### 1. 순차 스캔 (Sequential Scan)
- 테이블의 모든 데이터를 처음부터 끝까지 순차적으로 읽는 방식
- 장점: 모든 레코드를 검색해야 할 때 효율적
- 단점: 대용량 테이블에서는 속도가 느림
- 사용 시기: 테이블의 대부분의 데이터를 읽어야 할 때

### 2. 인덱스 스캔 (Index Scan)
- 인덱스를 사용하여 필요한 데이터만 선택적으로 접근
- 장점: 특정 조건의 데이터를 빠르게 찾을 수 있음
- 단점: 인덱스 유지 관리에 추가 비용 발생
- 사용 시기: WHERE 절에서 인덱스된 컬럼을 사용할 때

### 3. 비트맵 인덱스 스캔 (Bitmap Index Scan)
- 인덱스를 통해 비트맵을 생성하여 데이터 접근
- 장점: 여러 조건을 결합할 때 효율적
- 단점: 메모리 사용량이 증가할 수 있음
- 사용 시기: 여러 인덱스를 사용하는 복합 조건 검색시

### 4. 비트맵 힙 스캔 (Bitmap Heap Scan)
- 비트맵 인덱스 스캔 결과를 기반으로 실제 테이블 데이터에 접근
- 장점: 디스크 접근을 최적화할 수 있음
- 단점: 추가적인 메모리 필요
- 사용 시기: 비트맵 인덱스 스캔과 함께 사용됨

## 스캔 방식 선택 기준

PostgreSQL은 다음 요소들을 고려하여 스캔 방식을 선택합니다:
- 테이블 크기
- 인덱스 존재 여부
- WHERE 절의 조건
- 예상되는 결과 행의 수
- 시스템 리소스 상태

## 성능 최적화 팁

1. 적절한 인덱스 생성
2. 쿼리 실행 계획 분석 (EXPLAIN ANALYZE 활용)
3. 테이블 통계 정보 최신화 (ANALYZE 명령어 사용)
4. 불필요한 인덱스 제거

## 모니터링

```sql
-- 현재 실행 중인 쿼리의 스캔 방식 확인
SELECT pid, query, query_start, state
FROM pg_stat_activity
WHERE state != 'idle';

-- 테이블별 스캔 통계 확인
SELECT schemaname, relname, seq_scan, idx_scan
FROM pg_stat_user_tables;
```

## 참고사항
- PostgreSQL은 버전에 따라 지원하는 스캔 방식이 다를 수 있습니다
- 쿼리 플래너의 결정은 postgresql.conf의 설정값에 영향을 받을 수 있습니다
- EXPLAIN 명령어를 통해 실제 스캔 방식을 확인할 수 있습니다